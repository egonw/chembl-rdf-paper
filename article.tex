% PLEASE USE THIS FILE AS A TEMPLATE
% Check file iosart2c.tex for more examples
%
% Journal:
%   Journal of Ambient Intelligence and Smart Environments (jaise)
%   Web Intelligence and Agent Systems: An International Journal (wias)
%   Semantic Web: Interoperability, Usability, Applicability (SW)
% IOS Press
% Latex 2e

% options: jaise|wias|sw
% add. options: [seceqn,secfloat,secthm,crcready,onecolumn]


\documentclass[sw]{iosart2c}

%\documentclass[sw]{iosart2c}
%\documentclass[wias]{iosart2c}
%\documentclass[jaise]{iosart2c}

\usepackage[T1]{fontenc}
\usepackage{times}%
\usepackage{natbib}% for bibliography sorting/compressing
%\usepackage{amsmath}
%\usepackage{endnotes}
\usepackage{graphicx}
%\usepackage{tikz}
%\usetikzlibrary{snakes,arrows,shapes}

%%%%%%%%%%% Put your definitions here

% \bibliographystyle{plain} 
\bibliographystyle{unsrt} 

%%%%%%%%%%% End of definitions

\pubyear{0000}
\volume{0}
\firstpage{1}
\lastpage{1}

\begin{document}

\begin{frontmatter}

%\pretitle{}
\title{The ChEMBL database as Linked Open Data}
\runningtitle{ChEMBL-RDF}
%\subtitle{}

%\review{}{}{}


% For one author:
\author[A]{\fnms{Egon} \snm{Willighagen}\thanks{Corresponding author.\\ E-mail: egon.willighagen@maastrichtuniversity.nl.}}
% Two or more authors (order to be determined):
\author[B]{\fnms{Ola} \snm{Spjuth}},
\author[C]{\fnms{Peter} \snm{Ansell}},
\author[D]{\fnms{Antony} \snm{Williams}},
\author[E]{\fnms{Janna} \snm{Hastings}},
\author[F]{\fnms{John} \snm{Overington}},
\author[F]{\fnms{Anna} \snm{Gaulton}},

\address[A]{Department of Bioinformatics - BiGCaT, Maastricht University, ADDRESS, Maastricht,\\ The Netherlands\\
E-mail: egon.willighagen@maastrichtuniversity.nl}
\runningauthor{E.L. Willighagen et al.}
\address[B]{Uppsala University}
\address[C]{University of Queensland}
\address[D]{xxx}
\address[E]{ChEBI, European Bioinformatics Institute}
\address[F]{ChEMBL, European Bioinformatics Institute}

\begin{abstract}
This paper describes the continued conversion of ChEMBL data into RDF triples, using a few existing
ontologis, and demonstrates a few new use cases, taking advantage of its linked nature.
\end{abstract}

\begin{keyword}
% \sep 
Resource Description Framework, ChEMBL
\end{keyword}

\end{frontmatter}

%%%%%%%%%%% The article body starts:

\section{Introduction}\label{s1}

Despite the data deluge, finding new, unique, but significant patterns explaining biological
phenomena not yet understood is limited by the availability of data. Such data analysis is
beyond the scope is single data sets; it requires data integration from many sources, for
example, systems biology integrating micro-array differential expression to biological
pathways~\cite{}. Another prominent example is drug discovery where a new unique chemical entity is
searched with just the right biological properties. This too requires linking many
data sets~\cite{Samwald2011,OpenPHACTS}.

ChEMBL contains biological activities for over a million chemical entities, extracted from
literature, providing a unique resource for drug discovers~\cite{Warr2010}. Originally, this
data was available for download and via a web interface. The former requires setting up
the data in a relational database, while the latter limits the machine access to the data.
Two independent teams created RDF triples for the ChEMBL data, resulting in exposure
via Chem2Bio2RDF~\cite{} and ChEMBL-RDF~\cite{Willighagen2011}.

This paper presents the history of the ChEMBL-RDF data set, details of the latest structures
and ontologies used for the RDF version of ChEMBL 13, and a few new example use cases,
exemplifying how the data set can be linked to other data sources to further support
research in the life sciences.

\section{Methods}\label{s2}

The ChEMBL version used in this paper is ChEMBL 13, which was released on 29 February 2011.
RDF triples were created from a local MySQL database to which the SQL data dump of ChEMBL was
inserted, using a PHP script, available from source code hosting service
GitHub~\citep{ChEMBLRDFGitHub}, a process outlined earlier in a best practices note by
the international Health Care and Life Sciences XXX Working Group~\cite{Marshall2012}.

During the life time of this project, the ontologies used in ChEMBL-RDF have changed,
initially using a custom, ad-hoc ontology, but increasingly with community-proposed
ontologies, making the RDF more interoperable. The ChEMBL-RDF 13 uses ontology
standards like Bibliography Ontology for Citation Typinh Ontology for liteature
references, and domain ontologies like the Protein Ontology and the Chemical Information
Ontology. Throughout this paper, various prefixes are used to simplify RDF output, outlined
in Table~\ref{namespaces}.

To expose that ChEMBL-RDF data two approaches have been adopted. First, a SPARQL end point
hosted at Uppsala University, using the Open Source Virtuoso software. Use is free, but the
querying is capped, based on the estimated computational effort. Second, resources have
been made dereferencible using the Kasabi platform. This platform also provides a SPARQL
end point, but requires a user account.

As a method to further test the access and possibilities of this Linked Data version of
ChEMBL, a few new uses cases have been developed for this paper.

\section{Results}\label{s3}

\subsection{Data Statistics}

\# triples
\# links out
\# problems

The full set of triples are available from http://semantics.bigcat.unimaas.nl/chembl12/.

FIXME!

\subsection{Data Structure}

For each of the common resource classes a triple pattern was defined, following the
data available in the relational database.

Assays .... anything

\begin{small}
\begin{verbatim}
assay:a17
 a chembl:Assay ;
 chembl:extractedFrom
  res:r11347 ;
 chembl:hasAssayType chembl:ADMET ;
 chembl:hasConfScore "7"^^xsd:int ;
 chembl:hasDescription
  "Inhibition of cytochrome P450 progesterone 15-alpha hydroxylase" ;
 chembl:hasTarget target:t100122 .
\end{verbatim}
\end{small}

Targets ... protein, other

\begin{small}
\begin{verbatim}
target:t1
 a chembl:Target ;
 rdfs:subClassOf pro:PR_000000001 ;
 rdfs:label "Glucoamylase" , 
  "Maltase-glucoamylase, intestinal" ;
 dc:identifier "uniprot:O43451" , "3.2.1.3" ;
 dc:title "Maltase-glucoamylase" ;
 chembl:classL1 "Enzyme" ;
 chembl:hasDescription
  "Maltase-glucoamylase, intestinal" ;
 chembl:hasKeyword "Glycosidase" , 
  "Membrane" , "Sulfation" ;
 chembl:hasTaxonomy
  <http://bio2rdf.org/taxonomy:9606> ;
 chembl:organism "Homo sapiens" ;
 = <http://bio2rdf.org/uniprot:O43451> , 
   <http://bio2rdf.org/ec:3.2.1.3> .
\end{verbatim}
\end{small}

Activities ...

\begin{small}
\begin{verbatim}
act:a31863
 a       chembl:Activity ;
 cito:citesAsDataSource
  res:r6424 ;
 chembl:forMolecule mol:m180094 ;
 chembl:onAssay assay:a54505 ;
 chembl:relation ">" ;
 chembl:standardUnits
  "nM" ;
 chembl:standardValue
  "100000"^^xsd:float ;
 chembl:type "IC50" .
\end{verbatim}
\end{small}

Compounds ... Three types of compounds, peptides, small chemicals, ...

\begin{tiny}
\begin{verbatim}
m41:inchikey
      a       cheminf:CHEMINF_000059 ;
      cheminf:SIO_000300 "LMCOMIDLRGMFCZ-RIPOXUOASA-N" .

m41:smiles
      a       cheminf:CHEMINF_000018 ;
      cheminf:SIO_000300 "CC(C)C[C@@H]1N2C=CC(NC(=O)[C@H](Cc3ccccc3)N(C)C(=O)C(Cc4c[nH]c5ccccc45)NC(=O)C(CCC(=O)N)NC(=O)[C@@H](CCSCCSCC[C@H]6NC(=O)[C@H](CC(C)C)N7C=CC(NC(=O)[C@H](Cc8ccccc8)N(C)C(=O)C(Cc9c[nH]c%10ccccc9%10)NC(=O)C(CCC(=O)N)NC6=O)C7=O)NC1=O)C2=O" .

m41:inchi
      a       cheminf:CHEMINF_000113 ;
      cheminf:SIO_000300 "InChI=1S/C82H102N16O14S2/c1-47(2)39-67-77(107)89-59(73(103)87-57(25-27-69(83)99)71(101)93-63(43-51-45-85-55-23-15-13-21-53(51)55)79(109)95(5)65(41-49-17-9-7-10-18-49)75(105)91-61-29-33-97(67)81(61)111)31-35-113-37-38-114-36-32-60-74(104)88-58(26-28-70(84)100)72(102)94-64(44-52-46-86-56-24-16-14-22-54(52)56)80(110)96(6)66(42-50-19-11-8-12-20-50)76(106)92-62-30-34-98(82(62)112)68(40-48(3)4)78(108)90-60/h7-24,29-30,33-34,45-48,57-68,85-86H,25-28,31-32,35-44H2,1-6H3,(H2,83,99)(H2,84,100)(H,87,103)(H,88,104)(H,89,107)(H,90,108)(H,91,105)(H,92,106)(H,93,101)(H,94,102)/t57?,58?,59-,60-,61?,62?,63?,64?,65+,66+,67+,68+/m1/s1" .

chemblid:CHEMBL406142
      owl:equivalentClass mol:m41 .

mol:m41
      rdfs:label "CHEMBL406142" , "Bis(3-[14-Benzyl-11-(1H-indol-3-ylmethyl)-2-isobutyl-13-methyl-5-(2-methylsulfanyl-ethyl)-3,6,9,12,15,20-hexaoxo-1,4,7,10,13,16-hexaaza-bicyclo[15.2.1]icos-18-en-8-yl]-propionamide)" ;
      rdfs:subClassOf cheminf:CHEMINF_000000 ;
      cheminf:CHEMINF_000200
              m41:inchikey , m41:smiles , m41:inchi ;
      <http://www.blueobelisk.org/chemistryblogs/inchi>
              "InChI=1S/C82H102N16O14S2/c1-47(2)39-67-77(107)89-59(73(103)87-57(25-27-69(83)99)71(101)93-63(43-51-45-85-55-23-15-13-21-53(51)55)79(109)95(5)65(41-49-17-9-7-10-18-49)75(105)91-61-29-33-97(67)81(61)111)31-35-113-37-38-114-36-32-60-74(104)88-58(26-28-70(84)100)72(102)94-64(44-52-46-86-56-24-16-14-22-54(52)56)80(110)96(6)66(42-50-19-11-8-12-20-50)76(106)92-62-30-34-98(82(62)112)68(40-48(3)4)78(108)90-60/h7-24,29-30,33-34,45-48,57-68,85-86H,25-28,31-32,35-44H2,1-6H3,(H2,83,99)(H2,84,100)(H,87,103)(H,88,104)(H,89,107)(H,90,108)(H,91,105)(H,92,106)(H,93,101)(H,94,102)/t57?,58?,59-,60-,61?,62?,63?,64?,65+,66+,67+,68+/m1/s1" ;
      owl:equivalentClass <http://rdf.openmolecules.net/?InChI=1S/C82H102N16O14S2/c1-47(2)39-67-77(107)89-59(73(103)87-57(25-27-69(83)99)71(101)93-63(43-51-45-85-55-23-15-13-21-53(51)55)79(109)95(5)65(41-49-17-9-7-10-18-49)75(105)91-61-29-33-97(67)81(61)111)31-35-113-37-38-114-36-32-60-74(104)88-58(26-28-70(84)100)72(102)94-64(44-52-46-86-56-24-16-14-22-54(52)56)80(110)96(6)66(42-50-19-11-8-12-20-50)76(106)92-62-30-34-98(82(62)112)68(40-48(3)4)78(108)90-60/h7-24,29-30,33-34,45-48,57-68,85-86H,25-28,31-32,35-44H2,1-6H3,(H2,83,99)(H2,84,100)(H,87,103)(H,88,104)(H,89,107)(H,90,108)(H,91,105)(H,92,106)(H,93,101)(H,94,102)/t57?,58?,59-,60-,61?,62?,63?,64?,65+,66+,67+,68+/m1/s1> , <http://bio2rdf.org/chebi:100041> , chemblid:CHEMBL406142 .
\end{verbatim}
\end{tiny}

For documents little information is replicated from the database, taking advantage
of PubMed Identifiers (PMIDs) and Digital Object Identifiers (DOIs). URIs for the
latter can be resolved online, providing curated information on the identified
documents. For PubMed articles ...

\begin{tiny}
\begin{verbatim}
journal:j6c706049c2e08871b7c46a6528065736
 a bibo:Journal ;
 dc:title "J. Med. Chem." .

res:r1
 a bibo:Article ;
 rdfs:seeAlso <http://bio2rdf.org/pubmed:14695813> ;
 dc:date "2004" ;
 dc:isPartOf journal:j6c706049c2e08871b7c46a6528065736 ;
 bibo:issue "1" ;
 bibo:pageEnd "9" ;
 bibo:pageStart "1" ;
 bibo:pmid "14695813" ;
 bibo:volume "47" .
\end{verbatim}
\end{tiny}

\subsection{SPARQL end points}

Previously, a SPARQL end point has been set up at Uppsala University.

\subsubsection{Bio2RDF}

Peter: write up the proxying... if that still works...

The Bio2RDF project provides both resolvable Linked Data URIs using a generic Linked Data server \cite{Ansell2011}, and access to SPARQL endpoints for a range of scientific databases \cite{Belleau2008}. A number of these databases are referenced in Chembl, including Chebi, Pubmed, and both the Uniprot protein and taxonomy databases \cite{TheUniProtConsortium2010}. These links are vital to provide context for users who need to query across both Chembl and its related databases. The Linked Data server used by Bio2RDF has been configured for Chembl to provide URL based services for text and link searches.

\subsubsection{Data Statistics and Validation}

John/Anna: common statistics with SPARQL

%\subsubsection{CitedIn}

%Andra: use the SPARQL end point to find which entries in ChEMBL cite what papers
 
%The link between data and formal publication is important in many areas of
%attribution, scientist ranking, etc, as outline in \cite{Waagmeester2012}.
%ChEMBL contains many literature references, and we wish to query this data
%for CitedIn.

\subsubsection{Decision Support}

Egon,Antony/Valery,Ola: develop and write up the Bioclipse Decision Support use case

\subsection{Linked Data on Kasabi}

Later, to satisfy the requirements for the Linked Open Drug Data \cite{Samwald2011}
network, the data was also hosted on Kasabi, a triple store hosting service
free for Open Data~\cite{kasabi}.

David: Chem2Bio2RDF

%\subsection{Use Case 2: Chem2Bio2RDF}

%David: Chem2Bio2RDF

\subsubsection{Linking out to ChemSpider}

Antony: if you can contribute ChemSpider IDs for the ChEMBL compounds ...

\subsubsection{Linking out to ChEMBL}

John/Anna: I can easily add links to webpages using foaf:homepage... are webpage URLs for entities stable enough?

\subsubsection{Linking out to Bio2RDF}

Peter/Egon: write up links to Bio2RDF for protein, pubmed, ...

\section{Discussion}

outlook ...

\section{Acknowledgements}

Tim and Foo of Kasabi. What S.H. Name of the Bioinformatics department at Uppsala University.

\begin{figure}[t]
\includegraphics[width=0.5\textwidth]{figs/relations}
\caption{The various resource types found in the ChEMBL triples. Some entities are subclasses
of common classes, while others are instances.}\label{f1}
\end{figure}

\begin{table*}
\caption{Prefixes and their matching namespaces used in this paper.} \label{namespaces}
\begin{tabular}{ll}
\hline
Common & Vocabularies \\
bibo    & Bibliography Ontology~\cite{Giasson2011} \\
        & http://purl.org/ontology/bibo/ \\
cheminf & Chemical Information Ontology~\cite{Hastings2011} \\
        & http://semanticscience.org/resource/ \\
cito    & Citation Typing Ontology~\cite{Shotton2010} \\
        & http://purl.org/spar/cito/ \\
pro     & PRotein Ontology~\cite{XXX} \\
        & http://cccccc.cc/xxxxxx/ \\

\hline
ChEMBL-RDF & Namespaces\\
act    & http://data.kasabi.com/dataset/chembl-rdf/activity/ \\
assay  & http://data.kasabi.com/dataset/chembl-rdf/assay/ \\
chembl & http://rdf.farmbio.uu.se/chembl/onto/\# \\
mol    & http://data.kasabi.com/dataset/chembl-rdf/molecule/ \\
res    & http://data.kasabi.com/dataset/chembl-rdf/resource/ \\
\hline
\end{tabular}
\end{table*}

\bibliography{article}

%%%%%%%%%%% The bibliography starts:
%\begin{thebibliography}{9}
%
%\bibitem{r1}
%
%\bibitem{r2}
%
%\end{thebibliography}

\end{document}
